# 智采云权限管理指南

## 概述

智采云采用基于角色的访问控制（RBAC）系统，为三种核心用户角色提供差异化的功能和数据访问权限。

## 用户角色

### 1. 采购总监 (Director)
**权限级别**: 完整权限 (Full Access)  
**AI访问级别**: Full  
**数据可见性**: 全局 (Global)

#### 功能权限
- ✅ 所有模块完整访问权限
- ✅ 所有AI功能完整访问
- ✅ 全局数据查看
- ✅ 战略决策数据访问
- ✅ 财务数据访问
- ✅ 系统配置管理

#### AI功能
- ✅ AI指挥中心 - 完整访问
- ✅ 智能预测引擎 - 完整功能
- ✅ 智能推荐系统 - 全局推荐
- ✅ 实时监控中心 - 全局监控
- ✅ 合同智能审查 - 完整访问
- ✅ AI高级分析 - 战略分析
- ✅ AI智能报告 - 管理层报告
- ✅ AI策略优化 - 全局优化
- ✅ AI流程自动化 - 完整自动化

#### 操作权限
- ✅ 审批采购申请
- ✅ 封禁供应商
- ✅ 签署/终止合同
- ✅ 管理用户
- ✅ 配置系统
- ✅ 查看审计日志
- ✅ 导出全局数据

### 2. 采购专员 (Specialist)
**权限级别**: 标准权限 (Standard Access)  
**AI访问级别**: Standard  
**数据可见性**: 部门级 (Department)

#### 功能权限
- ✅ 统一工作台
- ✅ AI指挥中心 - 标准访问
- ✅ 供应商360°
- ✅ 采办到支付
- ✅ 合同管理
- ❌ 系统设置

#### AI功能
- ✅ AI指挥中心 - 标准访问
- ✅ 智能预测引擎 - 执行层预测
- ✅ 智能推荐系统 - 个人推荐
- ✅ 实时监控中心 - 负责范围监控
- ✅ 合同智能审查 - 标准审查
- ✅ AI助手 - 工作辅助
- ✅ AI洞察卡片 - 业务洞察
- ✅ AI预测卡片 - 趋势预测
- ✅ AI风险监控 - 风险提醒
- ✅ AI智能报告 - 业务报告
- ✅ AI流程自动化 - 标准自动化
- ❌ AI高级分析 - 无权限
- ❌ AI策略优化 - 无权限

#### 数据访问权限
- ✅ 查看所有供应商
- ✅ 查看所有合同
- ✅ 查看所有订单
- ✅ 查看绩效数据
- ❌ 查看财务数据
- ❌ 查看战略数据

#### 操作权限
- ✅ 创建采购申请
- ✅ 执行采购
- ✅ 添加/编辑供应商
- ✅ 评估供应商
- ✅ 创建合同
- ✅ 审查合同
- ✅ 导出业务数据
- ❌ 审批采购 (需总监)
- ❌ 取消采购 (需总监)
- ❌ 封禁供应商 (需总监)
- ❌ 签署合同 (需总监)
- ❌ 终止合同 (需总监)
- ❌ 管理用户
- ❌ 配置系统

### 3. 业务申请人 (Applicant)
**权限级别**: 基础权限 (Basic Access)  
**AI访问级别**: Basic  
**数据可见性**: 个人级 (Personal)

#### 功能权限
- ✅ 统一工作台 - 个人工作台
- ✅ 采办到支付 - 申请提交
- ❌ AI指挥中心
- ❌ 供应商360°
- ❌ 合同管理
- ❌ 系统设置

#### AI功能
- ✅ AI助手 - 基础咨询
- ✅ 智能推荐 - 物品推荐
- ❌ AI指挥中心 - 无权限
- ❌ 智能预测引擎 - 无权限
- ❌ 实时监控中心 - 无权限
- ❌ 合同智能审查 - 无权限
- ❌ AI洞察卡片 - 无权限
- ❌ AI预测卡片 - 无权限
- ❌ AI风险监控 - 无权限
- ❌ 所有高级AI功能 - 无权限

#### 数据访问权限
- ✅ 查看自己的订单
- ❌ 查看其他数据

#### 操作权限
- ✅ 创建采购申请
- ✅ 取消自己的申请
- ❌ 所有供应商操作
- ❌ 所有合同操作
- ❌ 所有系统管理操作

## 权限使用示例

### 在组件中使用权限

```typescript
import { usePermissions } from '../hooks/usePermissions';

function MyComponent({ role }: { role: string }) {
  const { 
    canAccessModule,
    canUseAIFeature,
    canPerformAction,
    aiAccessLevel,
    roleName 
  } = usePermissions(role as UserRole);

  // 检查模块访问权限
  if (!canAccessModule('supplier360')) {
    return <PermissionDenied />;
  }

  // 检查AI功能权限
  const showAIPredictor = canUseAIFeature('smartPredictor');

  // 检查操作权限
  const canApprove = canPerformAction('approvePurchase');

  return (
    <div>
      {showAIPredictor && <AISmartPredictor />}
      {canApprove && <ApproveButton />}
    </div>
  );
}
```

### 权限检查函数

```typescript
// 检查模块访问
canAccessModule(role, 'aiCenter')

// 检查AI功能
canUseAIFeature(role, 'smartPredictor')

// 检查数据访问
canAccessData(role, 'viewFinancialData')

// 检查操作权限
canPerformAction(role, 'approvePurchase')
```

## AI功能分级详解

### Full Access (采购总监)
- 完整的AI指挥中心访问
- 战略级AI分析和预测
- 全局AI监控和优化
- AI策略规划建议
- 高级AI报告生成
- 完整的AI自动化配置

### Standard Access (采购专员)
- AI指挥中心标准访问
- 执行层AI预测和分析
- 部门级AI监控
- 业务流程AI优化
- 标准AI报告
- 基础AI自动化

### Basic Access (业务申请人)
- 基础AI助手咨询
- 简单的智能推荐
- 申请流程辅助
- 智能搜索功能

## 数据可见性分级

### Global (全局)
- 查看所有数据
- 跨部门数据分析
- 战略决策数据
- 财务敏感数据

### Department (部门级)
- 查看部门相关数据
- 负责范围内的数据
- 业务执行数据
- 绩效评估数据

### Personal (个人级)
- 仅查看个人数据
- 自己提交的申请
- 个人工作记录

## 权限提升流程

当用户尝试访问超出权限的功能时：

1. **UI层面**: 不显示无权限的菜单/按钮
2. **交互层面**: 显示权限提示信息
3. **数据层面**: 过滤掉无权限的数据
4. **操作层面**: 禁用无权限的操作

## 最佳实践

1. **最小权限原则**: 每个角色只拥有完成其工作所需的最小权限
2. **分级管理**: 通过AI访问级别实现渐进式功能开放
3. **数据隔离**: 根据数据可见性级别严格控制数据访问
4. **审计追踪**: 记录所有权限相关操作（仅总监可查看）
5. **动态调整**: 根据业务需求灵活调整权限配置

## 权限配置位置

- **权限定义**: `/utils/permissions.ts`
- **权限Hook**: `/hooks/usePermissions.ts`
- **使用示例**: 见各组件中的权限控制实现

## 注意事项

1. 所有AI功能都需要通过权限检查
2. 敏感数据（财务、战略）仅总监可访问
3. 关键操作（审批、签署）需要相应权限
4. 系统配置和用户管理仅总监可执行
5. AI助手会根据角色提供差异化的建议

## 后续扩展

系统支持以下扩展：
- 自定义角色
- 细粒度权限控制
- 动态权限分配
- 临时权限授予
- 权限审计日志
